<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counter Force Game - Easy Mode</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        body { font-family: Arial, sans-serif; background: #f0f8ff; margin: 0; padding: 20px; }
        header, nav { text-align: center; background: #007bff; color: white; padding: 10px; }
        nav ul { list-style: none; padding: 0; }
        nav ul li { display: inline; margin: 0 12px; }
        nav a { color: white; text-decoration: none; font-weight: bold; }
        main { max-width: 700px; margin: 0 auto; }
        canvas { border: 3px solid #007bff; background: #ffffff; display: block; margin: 20px auto; border-radius: 8px; }
        .instructions { background: #e8f4ff; padding: 15px; border-left: 5px solid #007bff; margin: 20px 0; }
        button { padding: 12px 24px; font-size: 18px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; }
        button:hover { background: #218838; }
        #info { font-size: 18px; margin: 10px 0; }
        #result { font-size: 22px; font-weight: bold; margin-top: 15px; }
    </style>
</head>
<body>

    <header>
        <h1>Counter Force Game</h1>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="quiz.html">Quiz</a></li>
            <li><a href="game.html">Game</a></li>
        </ul>
    </nav>

    <main>
        <div class="instructions">
            <h3>How to play (very easy version)</h3>
            <p>→ Hold <strong>LEFT ARROW</strong> or <strong>RIGHT ARROW</strong> to fight the pushing force.</p>
            <p>Goal: Keep the red ball in the middle of the gray platform as long as possible.</p>
            <p>The blue arrow is the action force — you apply the orange counter force.</p>
            <p>When balanced → green net force → you get points!</p>
        </div>

        <canvas id="canvas" width="600" height="350"></canvas>

        <div id="info">
            <div>Counter force: <span id="counter">0</span> N</div>
            <div>Score: <span id="score">0</span></div>
            <div>Time: <span id="time">0</span> s</div>
        </div>

        <button id="startBtn">Start / Restart</button>
        <div id="result"></div>
    </main>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const centerX = canvas.width / 2;

        let running = false;
        let ballX = centerX;
        let velocity = 0;
        let counterForce = 0;
        let actionForce = 50;
        let score = 0;
        let startTime = 0;
        let animationFrame;

        const platformLeft = 100;
        const platformRight = 500;
        const platformY = 220;

        function resetGame() {
            if (animationFrame) cancelAnimationFrame(animationFrame);
            ballX = centerX;
            velocity = 0;
            counterForce = 0;
            actionForce = Math.random() > 0.5 ? 40 : -40;
            score = 0;
            startTime = performance.now();
            document.getElementById('counter').textContent = 0;
            document.getElementById('score').textContent = 0;
            document.getElementById('time').textContent = 0;
            document.getElementById('result').textContent = '';
            running = true;
            gameLoop();
        }

        function gameLoop() {
            if (!running) return;

            const now = performance.now();
            const dt = (now - (lastTime || now)) / 1000;
            lastTime = now;

            // Update counter force (smooth when holding key)
            if (leftPressed)  counterForce -= 80 * dt;
            if (rightPressed) counterForce += 80 * dt;
            counterForce = Math.max(-150, Math.min(150, counterForce));

            // Physics - very slow movement
            const net = actionForce + counterForce;
            velocity += net * 8 * dt;          // very small acceleration
            velocity *= 0.94;                  // strong damping (stops quickly)
            ballX += velocity * 35 * dt;       // movement is gentle

            // Time & score
            const seconds = Math.floor((now - startTime) / 1000);
            document.getElementById('time').textContent = seconds;
            if (Math.abs(net) < 12) {
                score += 20 * dt;
                document.getElementById('score').textContent = Math.floor(score);
            }

            // Game over condition
            if (ballX < platformLeft - 20 || ballX > platformRight + 20) {
                running = false;
                document.getElementById('result').innerHTML = 
                    `<span style="color: darkred;">Game Over! Final score: ${Math.floor(score)}</span>`;
                return;
            }

            // Draw everything
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Platform
            ctx.fillStyle = "#777";
            ctx.fillRect(platformLeft, platformY, platformRight - platformLeft, 30);

            // Ball
            ctx.fillStyle = "#e63946";
            ctx.beginPath();
            ctx.arc(ballX, platformY - 10, 18, 0, Math.PI * 2);
            ctx.fill();

            // Force arrows (centered)
            drawArrow(centerX - 100, 60, actionForce,   "#457b9d", "Action");
            drawArrow(centerX - 100, 100, counterForce, "#f4a261", "Counter");
            drawArrow(centerX - 100, 140, net,          netColor(net), "Net");

            document.getElementById('counter').textContent = Math.round(counterForce);

            animationFrame = requestAnimationFrame(gameLoop);
        }

        function drawArrow(x, y, value, color, label) {
            const len = Math.min(Math.abs(value) * 1.4, 140);
            const dir = value >= 0 ? 1 : -1;
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + len * dir, y);
            ctx.stroke();

            // arrow head
            ctx.beginPath();
            ctx.moveTo(x + len * dir, y);
            ctx.lineTo(x + (len - 12) * dir, y - 8);
            ctx.lineTo(x + (len - 12) * dir, y + 8);
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();

            ctx.fillStyle = "#333";
            ctx.font = "14px Arial";
            ctx.fillText(label + ": " + Math.round(value) + " N", x - 30, y - 10);
        }

        function netColor(net) {
            const abs = Math.abs(net);
            if (abs < 12) return "#2ecc71";
            if (abs < 35) return "#f39c12";
            return "#e74c3c";
        }

        let leftPressed = false;
        let rightPressed = false;
        let lastTime = 0;

        window.addEventListener('keydown', e => {
            if (e.key === 'ArrowLeft')  leftPressed = true;
            if (e.key === 'ArrowRight') rightPressed = true;
        });

        window.addEventListener('keyup', e => {
            if (e.key === 'ArrowLeft')  leftPressed = false;
            if (e.key === 'ArrowRight') rightPressed = false;
        });

        document.getElementById('startBtn').onclick = resetGame;

        // Optional: start automatically on first load
        // resetGame();
    </script>
</body>
</html>